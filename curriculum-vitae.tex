%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Tabular Curriculum-Vitae                                                     %
% LaTeX Template                                                               %
% Version 2.0 (2021-04-07)                                                     %
%                                                                              %
% Copyright (c) 2021 Maximilian Schott                                         %
%                                                                              %
% License:                                                                     %
%   GPLv3 License                                                              %
%                                                                              %
% This template has been inspired by:                                          %
%   Plasmati Graduate CV by Alessandro Plasmati (alessandro.plasmati@gmail.com)%
%   Which is available at:                                                     %
%       http://www.LaTeXTemplates.com                                          %
%                                                                              %
% Important note:                                                              %
%   This template needs to be compiled with XeLaTeX or LuaTex due to fontspec  %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Set paper and font size
\documentclass[a4paper,10pt]{article}

\usepackage{fontspec}
\usepackage{xunicode,xltxtra,url,paralist,enumitem}
\usepackage{layouts}
\usepackage{xparse}

% Define custom colors
\usepackage[usenames,dvipsnames]{xcolor}
\definecolor{linkColor}{rgb}{0,0.2,0.6}
\definecolor{itemSubtextColor}{rgb}{0.3,0.3,0.3}

% A4 page margin, alternatively use \usepackage{fullpage}
\usepackage[big]{layaureo}

% Set default link color
\usepackage{hyperref}
\hypersetup{colorlinks,breaklinks,urlcolor=linkColor,linkcolor=linkColor}

% Customize \section formatting
\usepackage{titlesec}
\titleformat{name=\section}{\Large\scshape\raggedright}{}{0em}{}[\titlerule]
\titlespacing{\section}{0pt}{3pt}{3pt}

% Define left, center and right aligned columns with (fixed) width
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}
% Ugly minipage hack to reduce itemize item separator inside table cell
\newcolumntype{i}[1]%
    {>{\begin{minipage}[t]{\linewidth}%
        \let\\\tabularnewline%
        \begin{itemize}[leftmargin=\bulletpointsLeftMargin]%
        \addtolength{\rightskip}{0pt plus 50pt}% for raggedright
        \setlength{\itemsep}{-\parsep}%
            }L{#1}<{%
        \end{itemize}%
        \end{minipage}%
    }}

% ============================================================================ %
% Define cv lists, bullet lists, list entries and bullet points as well as seps

\DeclareDocumentCommand\cvPersonalData{ m m }{
    \vspace{3mm}
    \begin{minipage}{\linewidth-10pt}
        \begin{wrapfigure}{r}{\imageSize}
            \vspace*{-0.8\baselineskip}%
            \includegraphics[width=\imageSize]{#1}
        \end{wrapfigure}

        %~ % unbreakable whitespace, required for wrapfigure to work correctly
        % empty lines must be before and after
        % use makebox to make 0-width
        \makebox[0pt][l]{~}

        \begin{minipage}{\linewidth-10pt}
            \bgroup
            \def\arraystretch{1.5} % row margin multiplier
            \def\leftcolwidth{2.5cm} % left column size, right column size auto-calculated
            \begin{tabular*}{\linewidth}{R{\leftcolwidth}|L{\linewidth-\leftcolwidth-4.0\tabcolsep}}
                #2
            \end{tabular*}
            \egroup
        \end{minipage}
    \end{minipage}
    \vspace{5mm}
}

\DeclareDocumentCommand\cvList{ m }{
    \vspace{3mm}
    \begin{tabular*}{\tableWidth}{R{\leftColumnWidth}|L{\rightColumnWidth}}
        #1
    \end{tabular*}
    \vspace{5mm}
}

\DeclareDocumentCommand\cvBulletList{ m }{
    \vspace{3mm}
    \begin{tabular*}{\tableWidth}{R{\leftColumnWidth}|i{\rightColumnWidth}}
        #1
    \end{tabular*}
    \vspace{5mm}
}

\DeclareDocumentCommand\cvEntry{ m m d<> o d<> }{
    #1 & #2
    \IfValueTF{#4} {\newline
        \IfValueT{#3} {\vspace{#3}}
        {\color{itemSubtextColor}\footnotesize{#4}}
        \IfValueT{#5} {\vspace{#5}}
    }{
        \IfValueT{#3} {\vspace{#3}}
    }
    \tabularnewline
}

\DeclareDocumentCommand\bulletpoint{ m d<> g d<> }{
    \item #1
        \IfValueTF {#3} {
            \newline
            \IfValueTF {#2} {\vspace{#2}} {\vspace{2pt}}
            {\color{itemSubtextColor}\footnotesize{#3}}
            \IfValueTF {#4} {\vspace{#4}} {\vspace{4pt}}
        }{
            \IfValueTF {#2} {\vspace{#2}} {\vspace{4pt}}
        }
}

\newcommand{\cvRulerSep}{
    \multicolumn{2}{l}
    {\textcolor{lightgray}{\rule{\tableWidth-10pt}{0.4pt}}}
    \vspace{4pt}
    \tabularnewline
}

\newcommand{\cvInvisibleSep}{
    \multicolumn{2}{l}{}\tabularnewline
}
% ============================================================================ %

% entirely remove paragraph indentation
\setlength{\parindent}{0pt}

% imports for photo display
\usepackage{wrapfig, graphicx}


% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ %
%   Debugging                                                                  %
%----------------------------------------------------------------------------- %
% Show margin frames:                                                          %
% \usepackage{showframe}
%                                                                              %
% The following packages should be removed they are for demonstration purposes %
% only. Either simply comment out the import \usepackage statements or         %
% completely remove the statements:                                            %
\usepackage{mwe}
\usepackage[german]{babel}
\usepackage{blindtext}
\usepackage{lipsum}
%                                                                              %
% The following may help in determining alignment problems in tables within    %
% this document:                                                               %
% tw in cm:  \printinunitsof{cm}\prntlen{\tableWidth} \newline                         %
% leftColumnWidth in cm: \printinunitsof{cm}\prntlen{\leftColumnWidth}\newline                         %
% rightColumnWidth in cm: \printinunitsof{cm}\prntlen{\rightColumnWidth}\newline                         %
% textwidth in cm: \printinunitsof{cm}\prntlen{\textwidth}\newline             %
% linewidth in cm: \printinunitsof{cm}\prntlen{\linewidth}\newline             %
% ---------------------------------------------------------------------------- %


\begin{document}


% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ %
%                                                                              %
%                                                                              %
%                                  SETTINGS                                    %
%                                                                              %
%                                                                              %
% ---------------------------------------------------------------------------- %
%                                                                              %
% Remove page numbering                                                        %
\pagestyle{empty}
%                                                                              %
% Reduce top margin                                                            %
\addtolength{\voffset}{-0.8cm}
%                                                                              %
% Size of the small image in the personal details section                      %
% (Height of the image when scaled should be around 6-7cm)                     %
\def\imageSize{4cm}
%                                                                              %
% Size of the left column in cv tables                                         %
\def\leftColumnWidth{4.6cm}
%                                                                              %
% Margin left of the bullet points when using column type 'i', like in the     %
% experience section                                                           %
\def\bulletpointsLeftMargin{0.5cm}
%                                                                              %
% ---------------------------------------------------------------------------- %



% apparently tabular env adds a forced padding of 1pt on the left + 1pt
% (invisible) border, subtract 2pt to avoid affecting the right page margin
% additionally subtract 0.22pt to suppress some additional overflow messages
\def\tableWidth{\dimexpr \linewidth -2pt -0.22pt \relax}
% Somehow somewhere 0.4pt diff is added - probably by tabcolsep somehow (4x0.1)
\def\rightColumnWidth{\dimexpr \tableWidth -\leftColumnWidth -4.0\tabcolsep -0.4pt \relax}



% ############################################################################ %
%	NAME, IMAGE AND CONTACT INFORMATION                                        %
% ---------------------------------------------------------------------------- %

\par{\centering{\Huge Max Mustermann}\bigskip\par} % Your name

\vspace{3mm}

\section{Persönliche Daten}
\cvPersonalData{example-image}{
    \cvEntry{Geburtsdatum}{01. Januar 1970}
    \cvEntry{Geburtsort}{Musterstadt}
    \cvEntry{Nationalität}{deutsch}
    \cvEntry{Addresse}{Musterstraße 1, 11111 Musterstadt}
    \cvEntry{Mobil}{+49 1337 133333333337}
    \cvEntry{E-mail}{\href{mailto:max.mustermann@mustermail.com}{max.mustermann@mustermail.com}}
    \cvEntry{Github}{\href{https://github.com/maxmustermann}{github.com/maxmustermann}}
}


% ############################################################################ %
%   EDUCATION                                                                  %
%----------------------------------------------------------------------------- %

\section{Bildungsweg}
\cvList{
    \cvEntry{Oktober 1995}{Dipl. Ing. Maschinenbau (Abschluss-Note: 1,47)}[
        Technische Universität Musterstadt
    ]
    \cvInvisibleSep
    \cvEntry{Juli 1989}{Abitur (Abschluss-Note: 1,0)}[
        Städtisches Gymnasium Musterstadt
    ]
}


% ============================================================================ %
%	WORK EXPERIENCE                                                            %
%----------------------------------------------------------------------------- %

\section{Berufserfahrung}
\cvList{
    \cvEntry{Juli 2010 - März 2021}{Werks-Manager bei Motorenwerke Musterstadt}[
        \lipsum[8]\newline
        \href{https://www.motorenwerke-musterstadt.de/}{www.motorenwerke-musterstadt.de}
    ]
    \cvRulerSep
    \cvEntry{Dezember 1995 - Mai 2010}{Motoren-Entwickler bei Musterwerke GmbH}[
        \lipsum[2]
    ]
}


% ============================================================================ %
%	SKILLS                                                                     %
% ---------------------------------------------------------------------------- %

\section{Maschinenbau-Kenntnisse}
\cvBulletList{%
    \cvEntry{Fundierte Kenntnisse}{
        \bulletpoint{Wasserstoffmotoren}{\lipsum[10]}
        \bulletpoint{Eintrag mit Subtext}{\lipsum[20]}
        \bulletpoint{Ohne Sub-Text}
    }
    \cvRulerSep
    \cvEntry{Fortgeschrittene Kenntnisse}{
        \bulletpoint{Ohne nachfolgendem vertikalen Abstand}<0pt>
        \bulletpoint{Kein Abstand zum Subtext}<0pt>{\lipsum[21]}
        \bulletpoint{Langer vertikaler Abstand}<2cm>
        \bulletpoint{Platzhalter}
    }
}

% ============================================================================ %
%   LANGUAGES                                                                  %
% ---------------------------------------------------------------------------- %
\section{Sprachen}
\cvList{
    \cvEntry{Deutsch}{Muttersprache}
    \cvInvisibleSep
    \cvEntry{Englisch}{Flüssig in Wort und Schrift}
}

\end{document}
